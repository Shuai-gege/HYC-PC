(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07a8f476"],{"06cd":function(e,t,a){"use strict";var o=a("bc3a"),l=a.n(o),n=a("5c96"),r=a("4360"),s=a("5f87"),i=l.a.create({baseURL:"http://47.100.240.228:8950",timeout:3e7,responseType:"json"});i.interceptors.request.use((function(e){return r["a"].getters.token&&(e.headers["LinkAdmin-Token"]=Object(s["a"])()),e}),(function(e){return console.log(e),Promise.reject(e)})),i.interceptors.response.use((function(e){var t=e.data;return 2e4!==t.code?(Object(n["Message"])({message:t.msg||"Error",type:"error",duration:3e3}),50001===t.code&&n["MessageBox"].confirm("你已经退出系统了, 你可以取消停留在这一页, 或者再次登录","提示",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then((function(){r["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),Promise.reject(new Error(t.msg||"Error"))):t}),(function(e){return console.log("err"+e),Object(n["Message"])({message:e.message,type:"error",duration:3e3}),Promise.reject(e)})),t["a"]=i},"09f4":function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),Math.easeInOutQuad=function(e,t,a,o){return e/=o/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var o=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function l(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function n(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function r(e,t,a){var r=n(),s=e-r,i=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=i;var n=Math.easeInOutQuad(c,r,s,t);l(n),c<t?o(e):a&&"function"===typeof a&&a()};u()}},2887:function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return n})),a.d(t,"f",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return i})),a.d(t,"e",(function(){return c}));var o=a("b775");function l(e){return Object(o["a"])({url:"/rest/tbEventReport/getPCReportEventByPage",method:"post",data:e})}function n(e){return Object(o["a"])({url:"/rest/department/subCompanyList",method:"get",params:{uid:e}})}function r(e){return Object(o["a"])({url:"/rest/department/subDeptByDeptId",method:"get",params:{deptId:e}})}function s(e){return Object(o["a"])({url:"/rest/department/getCompanyByUid",method:"get",params:{uid:e}})}function i(e){return Object(o["a"])({url:"/rest/tbEventTypeConfig/list",method:"post",data:e})}function c(e){return Object(o["a"])({url:"/rest/department/subDeptByDeptId",method:"get",params:{deptId:e}})}},7318:function(e,t,a){"use strict";a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"b",(function(){return i}));var o=a("06cd");a("b775");function l(e){return Object(o["a"])({url:"/rest/taskRule/getTaskRulesByParam",method:"post",data:e})}function n(e){return Object(o["a"])({url:"/rest/taskRule/add",method:"post",data:e})}function r(e,t){return Object(o["a"])({url:"/rest/taskRule/getTaskRuleDetailByRuleId",method:"get",params:{ruleId:e,uid:t}})}function s(e){return Object(o["a"])({url:"/rest/taskRule/removeTaskRule",method:"get",params:{ruleId:e}})}function i(e){return Object(o["a"])({url:"/rest/taskRule/editTaskRule",method:"post",data:e})}},"82d6":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:3}},[a("el-select",{attrs:{placeholder:"部门"},on:{change:e.company},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-input",{attrs:{placeholder:"人员"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-input",{attrs:{placeholder:"任务名称"},model:{value:e.taskName,callback:function(t){e.taskName=t},expression:"taskName"}})],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-select",{attrs:{placeholder:"状态"},on:{change:e.state},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}},e._l(e.options1,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.xinZeng}},[e._v("新增")])],1)],1),e._v(" "),a("el-divider"),e._v(" "),a("div",[a("el-row",[a("el-col",{attrs:{span:23}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData2,height:"600",border:""}},[a("el-table-column",{attrs:{width:"50",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.$index+e.listQuery1.page*e.listQuery1.pageSize+1))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"taskName",label:"任务名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ruleType1",label:"规则类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ruleName",label:"巡更规则"}}),e._v(" "),a("el-table-column",{attrs:{prop:"defaultUserName",label:"默认分配人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"patroType1",label:"周期调班"}}),e._v(" "),a("el-table-column",{attrs:{prop:"patrolPointIdsCount",label:"巡检点数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"facePatrolPointIdsCount",label:"人脸核验点数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stop",label:"状态"}}),e._v(" "),a("el-table-column",{attrs:{prop:"zip",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.stop(t)}}},[e._v(e._s(t.row.stop1))]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.edit(t)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.checkOrder(t)}}},[e._v("查看")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.shanChu(t)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery1.page,limit:e.listQuery1.pageSize},on:{"update:page":function(t){return e.$set(e.listQuery1,"page",t)},"update:limit":function(t){return e.$set(e.listQuery1,"pageSize",t)},pagination:e.taskGuanLi}})],1)],1)],1),e._v(" "),a("div",[a("el-dialog",{attrs:{title:"新增",visible:e.dialogVisible,width:"80%","before-close":e.handleClose,top:"3vh"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("div",{staticClass:"flex"},[a("div",{staticStyle:{"padding-right":"10px"}},[a("el-form-item",{attrs:{label:"任务名称"}},[a("el-input",{attrs:{placeholder:"任务名称"},model:{value:e.form.taskName,callback:function(t){e.$set(e.form,"taskName",t)},expression:"form.taskName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"巡更规则"}},[a("el-select",{attrs:{placeholder:"任务规则"},on:{change:e.task},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}},e._l(e.form.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"巡更人员"}},[a("el-select",{attrs:{placeholder:"巡更人员"},on:{change:e.task1},model:{value:e.form.value1,callback:function(t){e.$set(e.form,"value1",t)},expression:"form.value1"}},e._l(e.form.options1,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),e.flag1?a("el-form-item",{attrs:{label:"默认分配人员"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:e.danXuan},model:{value:e.form.value5,callback:function(t){e.$set(e.form,"value5",t)},expression:"form.value5"}},e._l(e.form.options5,(function(e){return a("el-option",{key:e.uid,attrs:{label:e.vserName,value:e.uid}})})),1)],1):e._e(),e._v(" "),e.flag1?a("el-form-item",{attrs:{label:"调班起始日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","picker-options":e.pickerOptions0},on:{change:e.actionTime},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}})],1):e._e(),e._v(" "),e.flag1?a("el-form-item",{attrs:{label:"调班周期"}},[a("el-input",{attrs:{placeholder:"调班周期",onkeyup:"this.value = this.value.replace(/[^\\d.]/g,'');"},model:{value:e.form.cycle,callback:function(t){e.$set(e.form,"cycle",t)},expression:"form.cycle"}})],1):e._e(),e._v(" "),e.flag1?e._e():a("el-form-item",{attrs:{label:"人员选择"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:e.danXuan0},model:{value:e.form.value6,callback:function(t){e.$set(e.form,"value6",t)},expression:"form.value6"}},e._l(e.form.options6,(function(e){return a("el-option",{key:e.uid,attrs:{label:e.vserName,value:e.uid}})})),1)],1),e._v(" "),e.flag1?a("el-form-item",{attrs:{label:"人员选择"}},[a("el-select",{attrs:{filterable:"",multiple:"",placeholder:"请选择"},on:{change:e.duoXuan},model:{value:e.form.value2,callback:function(t){e.$set(e.form,"value2",t)},expression:"form.value2"}},e._l(e.form.options2,(function(e){return a("el-option",{key:e.uid,attrs:{label:e.vserName,value:e.uid}})})),1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"新增巡更点"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.newTask}},[e._v("新增巡更点")])],1)],1),e._v(" "),e.flag2?a("div",{staticStyle:{"border-left":"1px solid #000","padding-left":"10px",width:"80%"}},[a("el-row",{attrs:{span:23}},[a("el-col",{attrs:{span:8}},[a("el-select",{attrs:{placeholder:"建筑"},on:{change:e.comPanyId},model:{value:e.form.value3,callback:function(t){e.$set(e.form,"value3",t)},expression:"form.value3"}},e._l(e.form.options3,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-select",{attrs:{placeholder:"楼层"},on:{change:e.floor},model:{value:e.form.value4,callback:function(t){e.$set(e.form,"value4",t)},expression:"form.value4"}},e._l(e.form.options4,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark",height:"350px","row-key":"id"},on:{"selection-change":e.handleSelectionChange,"select-all":e.selectAll,select:e.eidtCheck}},[a("el-table-column",{attrs:{type:"selection","reserve-selection":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"buildingName",label:"建筑"}}),e._v(" "),a("el-table-column",{attrs:{prop:"floorName",label:"楼层"}}),e._v(" "),a("el-table-column",{attrs:{prop:"patrolPointCode",label:"巡更点编号","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"patrolName",label:"名称","show-overflow-tooltip":""}})],1)],1):e._e()]),e._v(" "),e.flag2?a("p",{staticStyle:{"font-size":"20px",color:"#000"}},[e._v("已勾选巡更点↓")]):e._e(),e._v(" "),e.flag2?a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData1,height:"251px"}},[a("el-table-column",{attrs:{prop:"buildingName",label:"建筑"}}),e._v(" "),a("el-table-column",{attrs:{prop:"floorName",label:"楼层"}}),e._v(" "),a("el-table-column",{attrs:{prop:"patrolPointCode",label:"巡更点编号","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"patrolName",label:"名称","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"人脸核验"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-checkbox",{on:{change:function(a){return e.check(t)}},model:{value:t.row.checked,callback:function(a){e.$set(t.row,"checked",a)},expression:"scope.row.checked"}})]}}],null,!1,3417909836)})],1):e._e()],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.end}},[e._v("确 定")])],1)],1)],1),e._v(" "),a("div",[a("el-dialog",{attrs:{title:"编辑",visible:e.dialogVisible1,width:"80%","before-close":e.handleClose,top:"3vh"},on:{"update:visible":function(t){e.dialogVisible1=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("div",{staticClass:"flex"},[a("div",{staticStyle:{"padding-right":"10px"}},[a("el-form-item",{attrs:{label:"任务名称"}},[a("el-input",{attrs:{placeholder:"任务名称"},on:{input:e.ipt},model:{value:e.form.taskName,callback:function(t){e.$set(e.form,"taskName",t)},expression:"form.taskName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"巡更规则"}},[a("el-select",{attrs:{placeholder:"任务规则"},on:{change:e.task},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}},e._l(e.form.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"巡更人员"}},[a("el-select",{attrs:{placeholder:"巡更人员"},on:{change:e.task1},model:{value:e.form.value1,callback:function(t){e.$set(e.form,"value1",t)},expression:"form.value1"}},e._l(e.form.options1,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),e.flag1?a("el-form-item",{attrs:{label:"默认分配人员"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:e.danXuan},model:{value:e.form.value5,callback:function(t){e.$set(e.form,"value5",t)},expression:"form.value5"}},e._l(e.form.options5,(function(e){return a("el-option",{key:e.uid,attrs:{label:e.vserName,value:e.uid}})})),1)],1):e._e(),e._v(" "),e.flag1?a("el-form-item",{attrs:{label:"调班起始日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","picker-options":e.pickerOptions0},on:{change:e.actionTime},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}})],1):e._e(),e._v(" "),e.flag1?a("el-form-item",{attrs:{label:"调班周期"}},[a("el-input",{attrs:{placeholder:"调班周期",onkeyup:"this.value = this.value.replace(/[^\\d.]/g,'');"},on:{input:e.ipt1},model:{value:e.form.cycle,callback:function(t){e.$set(e.form,"cycle",t)},expression:"form.cycle"}})],1):e._e(),e._v(" "),e.flag1?e._e():a("el-form-item",{attrs:{label:"人员选择"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:e.danXuan0},model:{value:e.form.value6,callback:function(t){e.$set(e.form,"value6",t)},expression:"form.value6"}},e._l(e.form.options6,(function(e){return a("el-option",{key:e.uid,attrs:{label:e.vserName,value:e.uid}})})),1)],1),e._v(" "),e.flag1?a("el-form-item",{attrs:{label:"人员选择"}},[a("el-select",{attrs:{filterable:"",multiple:"",placeholder:"请选择"},on:{change:e.duoXuan},model:{value:e.form.value2,callback:function(t){e.$set(e.form,"value2",t)},expression:"form.value2"}},e._l(e.form.options2,(function(e){return a("el-option",{key:e.uid,attrs:{label:e.vserName,value:e.uid}})})),1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"新增巡更点"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.newTask}},[e._v("新增巡更点")])],1)],1),e._v(" "),a("div",{staticStyle:{"border-left":"1px solid #000","padding-left":"10px",width:"80%"}},[a("el-row",{attrs:{span:23}},[a("el-col",{attrs:{span:8}},[a("el-select",{attrs:{placeholder:"建筑"},on:{change:e.comPanyId},model:{value:e.form.value3,callback:function(t){e.$set(e.form,"value3",t)},expression:"form.value3"}},e._l(e.form.options3,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-select",{attrs:{placeholder:"楼层"},on:{change:e.floor},model:{value:e.form.value4,callback:function(t){e.$set(e.form,"value4",t)},expression:"form.value4"}},e._l(e.form.options4,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),a("el-table",{ref:"multipleTable1",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark",height:"350px","row-key":"id"},on:{"selection-change":e.handleSelectionChange,"select-all":e.selectAll,select:e.eidtCheck}},[a("el-table-column",{attrs:{type:"selection","reserve-selection":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"buildingName",label:"建筑"}}),e._v(" "),a("el-table-column",{attrs:{prop:"floorName",label:"楼层"}}),e._v(" "),a("el-table-column",{attrs:{prop:"patrolPointCode",label:"巡更点编号","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"patrolName",label:"名称","show-overflow-tooltip":""}})],1)],1)]),e._v(" "),a("p",{staticStyle:{"font-size":"20px",color:"#000"}},[e._v("已勾选巡更点↓")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData1,height:"251px"}},[a("el-table-column",{attrs:{prop:"buildingName",label:"建筑"}}),e._v(" "),a("el-table-column",{attrs:{prop:"floorName",label:"楼层"}}),e._v(" "),a("el-table-column",{attrs:{prop:"patrolPointCode",label:"巡更点编号","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"patrolName",label:"名称","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"人脸核验"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-checkbox",{on:{change:function(a){return e.check1(t)}},model:{value:t.row.checked,callback:function(a){e.$set(t.row,"checked",a)},expression:"scope.row.checked"}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.editEnd}},[e._v("确 定")])],1)],1)],1),e._v(" "),a("div",[a("el-dialog",{attrs:{title:"详情",visible:e.dialogVisible2,width:"80%"},on:{"update:visible":function(t){e.dialogVisible2=t}}},[a("div",{staticStyle:{display:"flex"}},[a("el-date-picker",{attrs:{type:"datetimerange",format:"yyyy-MM-dd","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.arrTime,blur:e.move},model:{value:e.timeVal,callback:function(t){e.timeVal=t},expression:"timeVal"}}),e._v(" "),a("el-input",{staticStyle:{width:"200px",margin:"0 50px"},attrs:{placeholder:"请输入被分配人"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.queDing}},[e._v("确定")])],1),e._v(" "),a("el-row",[a("el-divider"),e._v(" "),a("el-col",{attrs:{span:23}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData3,height:"400",border:""}},[a("el-table-column",{attrs:{prop:"executeUserName",label:"被分配人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"startTime",label:"开始时间",formatter:e.startTime}}),e._v(" "),a("el-table-column",{attrs:{prop:"endTime",label:"结束时间",formatter:e.endTime}}),e._v(" "),a("el-table-column",{attrs:{prop:"facePatrolPointIdsCount",label:"人脸核验"}}),e._v(" "),a("el-table-column",{attrs:{prop:"patrolPointIdsCount",label:"巡更点数"}})],1),e._v(" "),a("el-pagination",{attrs:{"page-sizes":[50,100,200,500,1e3],"page-size":50,layout:"total, sizes, prev, pager, next, jumper",total:e.total1},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)],1)],1)},l=[],n=(a("28a5"),a("7f7f"),a("ac6a"),a("96cf"),a("3b8d")),r=a("b8b9"),s=a("bd17"),i=a("2887"),c=a("7318"),u=a("333d"),p={components:{Pagination:u["a"]},watch:{timeVal:function(e){null==e&&(this.listQuery2.startTime="",this.listQuery2.endTime="")}},data:function(){return{input:"",pickerOptions0:{disabledDate:function(e){return e.getTime()<Date.now()}},listQuery:{uid:localStorage.getItem("uid")},listQuery1:{page:0,pageSize:50,uid:localStorage.getItem("uid")},listQuery2:{page:1,pageSize:50,uid:localStorage.getItem("uid")},multipleSelection:[],value:"",options:[],value1:"",timeVal:[],options1:[{value:"",label:"全部"},{value:"0",label:"启用"},{value:"1",label:"停用"}],name:"",taskName:"",dialogVisible:!1,dialogVisible1:!1,dialogVisible2:!1,checked:"",checked1:"",flag:!0,flag1:!1,flag2:!1,form:{time:"",taskName:"",cycle:"",value:"",options:[],value1:"0",options1:[{value:"0",label:"指定人员"},{value:"1",label:"周期调班"}],value2:"",options2:[],value3:"0",options3:[],value4:"0",options4:[],value5:"",options5:[],value6:"",options6:[]},tableData:[],tableData1:[],tableData2:[],tableData3:[],total:0,total1:0,loading:!0,facePatrolPointIdsArr:[],arr:[],userObj:[],newTaskList:{uid:localStorage.getItem("uid"),companyId:localStorage.getItem("deptid"),facePatrolPointIds:"",patroType:"1"}}},mounted:function(){this.tbEventTypeConfig(),this.companyDept(localStorage.getItem("deptid")),this.getTaskList(),this.taskRule(),this.taskGuanLi(),this.buMen(),this.getFloor("")},methods:{startTime:function(e,t,a,o){var l=new Date(a),n=l.getFullYear()+"-",r=(l.getMonth()+1<10?"0"+(l.getMonth()+1):l.getMonth()+1)+"-",s=(l.getDate()<10?"0"+l.getDate():l.getDate())+" ",i=(l.getHours()<10?"0"+l.getHours():l.getHours())+":",c=l.getMinutes()<10?"0"+l.getMinutes():l.getMinutes();return n+r+s+i+c},endTime:function(e,t,a,o){var l=new Date(a),n=l.getFullYear()+"-",r=(l.getMonth()+1<10?"0"+(l.getMonth()+1):l.getMonth()+1)+"-",s=(l.getDate()<10?"0"+l.getDate():l.getDate())+" ",i=(l.getHours()<10?"0"+l.getHours():l.getHours())+":",c=l.getMinutes()<10?"0"+l.getMinutes():l.getMinutes();return n+r+s+i+c},arrTime:function(e){console.log(e);var t=e[0],a=t.getFullYear(),o=this.p(t.getMonth()+1),l=this.p(t.getDate()),n=this.p(t.getHours()),r=this.p(t.getMinutes());this.listQuery2.startTime=a+"/"+o+"/"+l+" "+n+":"+r+":00";var s=e[1],i=s.getFullYear(),c=this.p(s.getMonth()+1),u=this.p(s.getDate());this.p(s.getHours()),this.p(s.getMinutes());this.listQuery2.endTime=i+"/"+c+"/"+u+" 23:59:59",console.log(a+"-"+o+"-"+l),console.log(i+"-"+c+"-"+u)},move:function(e){console.log(e)},buMen:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(i["f"])(localStorage.getItem("deptid"));case 3:t=e.sent,console.log(t),this.options=t.result,this.options.forEach((function(e){a.$set(e,"value",e.id),a.$set(e,"label",e.name)})),this.options.unshift({value:"",label:"全部"}),console.log(this.options),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}(),taskGuanLi:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.listQuery1.page=0,e.prev=1,e.next=4,Object(r["d"])(this.listQuery1);case 4:t=e.sent,this.loading=!1,this.total=t.data.records,this.tableData2=t.data.rows,this.tableData2.forEach((function(e){0==e.stopTag?(a.$set(e,"stop","启用"),a.$set(e,"stop1","停用")):(a.$set(e,"stop","停用"),a.$set(e,"stop1","启用")),0==e.ruleType?a.$set(e,"ruleType1","日任务"):1==e.ruleType?a.$set(e,"ruleType1","周任务"):2==e.ruleType?a.$set(e,"ruleType1","月任务"):3==e.ruleType&&a.$set(e,"ruleType1","季任务"),1==e.patroType?a.$set(e,"patroType1","唯一指定"):a.$set(e,"patroType1","周期调班")})),console.log(t),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,this,[[1,12]])})));function t(){return e.apply(this,arguments)}return t}(),delete:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(r["f"])(t);case 3:e.sent,this.$message({message:"删除成功",type:"success"}),this.taskGuanLi(),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(t){return e.apply(this,arguments)}return t}(),taskRule:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(c["d"])({uid:localStorage.getItem("uid")});case 3:t=e.sent,this.form.options=t.data.rows,this.form.options.forEach((function(e){a.$set(e,"value",e.id),a.$set(e,"label",e.ruleName)})),console.log(t),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}(),chaKan:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(r["e"])(this.listQuery2);case 3:t=e.sent,this.total1=t.data.records,this.tableData3=t.data.rows,console.log(t),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}(),queDing:function(){this.listQuery2.executeUserName=this.input,console.log(this.listQuery2),this.chaKan()},xinZeng:function(){this.dialogVisible=!0,this.tbEventTypeConfig(),this.taskRule(),this.getTaskList()},newTask:function(){this.flag2?this.flag2=!1:this.flag2=!0},edit:function(e){var t=this;this.tbEventTypeConfig(),this.taskRule(),console.log(e);var a=e.row;this.dialogVisible1=!0,this.form.value5=a.defaultUserId,this.form.time=a.trimWorkDate,this.form.cycle=a.trimWorkCycle,null!=a.allocationUserIds&&(this.form.value2=a.allocationUserIds.split(",")),this.$nextTick((function(){t.tableData1.forEach((function(e){t.$refs.multipleTable1.toggleRowSelection(e,!0)}))})),2==a.patroType?(this.flag1=!0,this.value1="1"):(this.flag1=!1,this.value1="0"),this.form.taskName=a.taskName,this.form.value=a.ruleName,1==a.patroType?(this.form.value1="0",this.form.value6=a.defaultUserId):this.form.value1="1";for(var o=a.patrolPointIds.split(","),l=0;l<o.length;l++)for(var n=0;n<this.tableData.length;n++)this.tableData[n].id==o[l]&&this.tableData1.push(this.tableData[n]);var r=a.facePatrolPointIds.split(",");console.log(this.tableData1),console.log("this.tableData1");for(var s=0;s<r.length;s++)for(var i=0;i<this.tableData1.length;i++)this.tableData1[i].id==r[s]&&(console.log(this.tableData[i]),console.log("上头"),this.tableData1[i].checked=!0);this.newTaskList.allocationUserIds=a.allocationUserIds,this.newTaskList.ruleId=a.ruleId,this.newTaskList.patroType=a.patroType,this.newTaskList.defaultUserId=a.defaultUserId,this.newTaskList.facePatrolPointIds=a.facePatrolPointIds,this.facePatrolPointIdsArr.push(a.facePatrolPointIds),this.newTaskList.defaultUserId=a.defaultUserId,this.newTaskList.trimWorkDate=a.trimWorkDate,this.newTaskList.trimWorkCycle=a.trimWorkCycle,this.newTaskList.taskName=a.taskName,this.newTaskList.patrolPointIds=a.patrolPointIds,this.newTaskList.id=a.id},ipt:function(e){this.newTaskList.taskName=e},ipt1:function(e){this.newTaskList.trimWorkCycle=e},bianJi:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(r["b"])(t);case 3:a=e.sent,console.log(a),2e4==a.code&&history.go(0),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));function t(t){return e.apply(this,arguments)}return t}(),editEnd:function(){var e=[];this.tableData1.forEach((function(t){e.push(t.id)})),this.newTaskList.patrolPointIds=e.join(),this.newTaskList.trimWorkCycle=this.form.cycle,0==this.tableData1.length?this.$message({message:"请选择巡更点",type:"warning"}):this.bianJi(this.newTaskList)},shanChu:function(e){this.delete(e.row.id)},checkOrder:function(e){console.log(e),this.dialogVisible2=!0,this.listQuery2.taskId=e.row.id,console.log(this.listQuery2),this.chaKan()},taskStop:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(r["g"])(t);case 3:a=e.sent,console.log(a),setTimeout((function(){o.taskGuanLi()}),100),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));function t(t){return e.apply(this,arguments)}return t}(),stop:function(e){var t=e.row.id;console.log(e),this.taskStop(t)},company:function(e){console.log(e),this.listQuery1.deptId=e},handleClose:function(e){this.$confirm("确认关闭？关闭后页面将刷新").then((function(t){history.go(0),e()})).catch((function(e){}))},state:function(e){this.listQuery1.stopTag=e},task:function(e){console.log(e),this.newTaskList.ruleId=e},getTaskList:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(s["f"])(this.listQuery);case 3:t=e.sent,console.log(t),this.tableData=t.data.rows,this.tableData.forEach((function(e){a.$set(e,"checked",!1),a.$set(e,"checked1",!1)})),console.log(this.tableData),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(){return e.apply(this,arguments)}return t}(),task1:function(e){console.log(e),0==e?(this.flag1=!1,this.newTaskList.patroType="1"):(this.flag1=!0,this.newTaskList.patroType="2")},duoXuan:function(e){console.log(e),this.userObj=e,this.newTaskList.allocationUserIds=e.join(",")},check:function(e){console.log(e),1==e.row.checked?this.facePatrolPointIdsArr.push(e.row.id):-1!=this.facePatrolPointIdsArr.indexOf(e.row.id)&&this.facePatrolPointIdsArr.splice(this.facePatrolPointIdsArr.indexOf(e.row.id),1),this.newTaskList.facePatrolPointIds=this.facePatrolPointIdsArr.join(),console.log(this.newTaskList.facePatrolPointIds)},check1:function(e){console.log(e),this.facePatrolPointIdsArr=this.newTaskList.facePatrolPointIds.split(","),0==e.row.checked?-1!=this.facePatrolPointIdsArr.indexOf(e.row.id)&&this.facePatrolPointIdsArr.splice(this.facePatrolPointIdsArr.indexOf(e.row.id),1):this.facePatrolPointIdsArr.push(e.row.id);var t=[];this.facePatrolPointIdsArr.forEach((function(e){""!=e&&t.push(e)})),console.log(t),this.newTaskList.facePatrolPointIds=t.join(),console.log(this.newTaskList.facePatrolPointIds)},eidtCheck:function(e,t){var a=this.newTaskList.facePatrolPointIds.split(",");1==t.checked?(console.log(a),-1!=a.indexOf(t.id)&&a.splice(a.indexOf(t.id),1)):-1!=a.indexOf(t.id)&&a.splice(a.indexOf(t.id),1),this.newTaskList.facePatrolPointIds=a.join(","),this.$set(t,"checked",!1),console.log(this.newTaskList)},del:function(e){var t=this;console.log(e),this.tableData1.forEach((function(a,o){if(a.id==e.row.id)return t.tableData1.splice(o,1)})),e.row?this.$refs.multipleTable.toggleRowSelection(e.row):this.$refs.multipleTable.clearSelection()},del1:function(e){var t=this;console.log(e),this.tableData1.forEach((function(a,o){if(a.id==e.row.id)return t.tableData1.splice(o,1)})),this.facePatrolPointIdsArr=this.newTaskList.facePatrolPointIds.split(","),this.facePatrolPointIdsArr.splice(this.facePatrolPointIdsArr.indexOf(e.row.id),1),this.newTaskList.facePatrolPointIds=this.facePatrolPointIdsArr.join(","),console.log(this.newTaskList.facePatrolPointIds)},danXuan:function(e){console.log(e),this.newTaskList.defaultUserId=e},danXuan0:function(e){console.log(e),this.newTaskList.defaultUserId=e},tbEventTypeConfig:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(r["c"])(localStorage.getItem("uid"));case 3:t=e.sent,this.form.options2=t.result,this.form.options2.forEach((function(e){a.$set(e,"value",e.uid),a.$set(e,"label",e.vserName)})),this.form.options5=t.result,this.form.options5.forEach((function(e){a.$set(e,"value",e.uid),a.$set(e,"label",e.vserName)})),this.form.options6=t.result,this.form.options6.forEach((function(e){a.$set(e,"value",e.uid),a.$set(e,"label",e.vserName)})),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));function t(){return e.apply(this,arguments)}return t}(),companyDept:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(s["d"])(t);case 3:a=e.sent,this.form.options3=a.result,this.form.options3.forEach((function(e){o.$set(e,"label",e.locationName),o.$set(e,"value",e.id)})),this.form.options3.unshift({value:"0",label:"全部"}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(t){return e.apply(this,arguments)}return t}(),getFloor:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(s["b"])(t);case 3:a=e.sent,this.form.options4=a.result,this.form.options4.forEach((function(e){o.$set(e,"label",e.locationName),o.$set(e,"value",e.id)})),this.form.options4.unshift({value:"0",label:"全部"}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(t){return e.apply(this,arguments)}return t}(),newAdd:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(r["a"])(t);case 3:a=e.sent,this.$message({message:"新增成功",type:"success"}),history.go(0),this.taskGuanLi(),console.log(a),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(t){return e.apply(this,arguments)}return t}(),floor:function(e){0==e?(this.listQuery.floorId="",this.getTaskList()):(this.listQuery.floorId=e,this.getTaskList()),console.log(e)},p:function(e){return e<10?"0"+e:e},actionTime:function(e){console.log(e);var t=new Date(e);this.newTaskList.trimWorkDate=this.p(t.getFullYear())+"-"+this.p(t.getMonth()+1)+"-"+this.p(t.getDate())},comPanyId:function(e){0==e?(this.listQuery.buildingId="",this.getTaskList()):(this.getFloor(e),this.listQuery.buildingId=e,this.getTaskList()),console.log(e)},end:function(){this.newTaskList.trimWorkCycle=this.form.cycle,this.newTaskList.taskName=this.form.taskName;var e=[];this.tableData1.forEach((function(t){e.push(t.id)})),this.newTaskList.patrolPointIds=e.join(),console.log(),""==this.form.taskName?this.$message({message:"请填写任务名称",type:"warning"}):""==this.form.value?this.$message({message:"请选择任务规则",type:"warning"}):"0"==this.form.value1?(console.log("我是指定"),""==this.form.value6?this.$message({message:"请选择人员",type:"warning"}):0==this.tableData1.length?this.$message({message:"请选择巡更点",type:"warning"}):(this.dialogVisible=!1,this.newAdd(this.newTaskList),this.form={time:"",taskName:"",cycle:"",value:"",options:[],value1:"0",options1:[{value:"0",label:"指定人员"},{value:"1",label:"周期调班"}],value2:"",options2:[],value3:"0",options3:[],value4:"0",options4:[],value5:"",options5:[],value6:"",options6:[]})):"1"==this.form.value1&&(console.log("我是周期"),""==this.form.value5?this.$message({message:"请选择默认人员",type:"warning"}):""==this.form.time?this.$message({message:"请选起始日期",type:"warning"}):""==this.form.cycle?this.$message({message:"请填写调班周期",type:"warning"}):this.userObj.length<2?(console.log("是不是你"),this.$message({message:"调班人员最少需要两位",type:"warning"})):0==this.tableData1.length?this.$message({message:"请选择巡更点",type:"warning"}):(this.dialogVisible=!1,this.newAdd(this.newTaskList),this.form={time:"",taskName:"",cycle:"",value:"",options:[],value1:"0",options1:[{value:"0",label:"指定人员"},{value:"1",label:"周期调班"}],value2:"",options2:[],value3:"0",options3:[],value4:"0",options4:[],value5:"",options5:[],value6:"",options6:[]})),console.log(this.newTaskList),console.log(this.tableData1)},allTask:function(e){console.log(e),this.flag=0==e},selectAll:function(e){var t=this;if(console.log(e),console.log("selected"),0==e.length)this.tableData1=[],this.newTaskList.facePatrolPointIds="";else{var a=[];this.tableData1.forEach((function(e){1==e.checked&&a.push(e.id),t.newTaskList.facePatrolPointIds=a.join(",")}))}},handleSelectionChange:function(e){var t=this;console.log(e),this.multipleSelection=e,this.arr=[],e.forEach((function(e){t.arr.push(e.id)})),this.tableData1.forEach((function(t){e.forEach((function(e){t.id==e.id&&(e.checked=t.checked)}))})),this.tableData1=e},handleSizeChange:function(e){this.listQuery2.pageSize=e,this.chaKan()},handleCurrentChange:function(e){this.listQuery2.page=e,this.chaKan()},query:function(){this.listQuery1.taskName=this.taskName,this.listQuery1.defaultUserName=this.name,console.log(this.listQuery1),this.taskGuanLi()}}},f=p,d=(a("e674"),a("2877")),h=Object(d["a"])(f,o,l,!1,null,"0604c11a",null);t["default"]=h.exports},b8b9:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"g",(function(){return i})),a.d(t,"f",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"b",(function(){return p}));var o=a("06cd"),l=a("b775");function n(e){return Object(l["a"])({url:"/rest/department/getCompanyAllUser",method:"get",params:{id:e}})}function r(e){return Object(o["a"])({url:"/rest/patrolTask/add",method:"post",data:e})}function s(e){return Object(o["a"])({url:"/rest/patrolTask/getPatrolTaskList",method:"post",data:e})}function i(e){return Object(o["a"])({url:"/rest/patrolTask/stopPatrolTask",method:"get",params:{id:e}})}function c(e){return Object(o["a"])({url:"/rest/patrolTask/removePatrolTask",method:"get",params:{id:e}})}function u(e){return Object(o["a"])({url:"/rest/patrolTask/getTaskDetailsByParam",method:"post",data:e})}function p(e){return Object(o["a"])({url:"/rest/patrolTask/editPatrolTask",method:"post",data:e})}},bd17:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return i})),a.d(t,"f",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"k",(function(){return p})),a.d(t,"i",(function(){return f})),a.d(t,"g",(function(){return d})),a.d(t,"j",(function(){return h})),a.d(t,"h",(function(){return m})),a.d(t,"e",(function(){return v}));var o=a("06cd"),l=a("b775"),n=a("7605");function r(e){return Object(l["a"])({url:"/rest/department/getCompanyByUid",method:"get",params:{uid:e}})}function s(e){return Object(n["a"])({url:"/rest/buildingLocation/getCompanyDeptByCompanyId",method:"get",params:{company_id:e}})}function i(e){return Object(n["a"])({url:"/rest/buildingLocation/getBuildingLocationFloor",method:"get",params:{parentId:e}})}function c(e){return Object(o["a"])({url:"/rest/patrolPoint/getPatrolPointList",method:"post",data:e})}function u(e){return Object(o["a"])({url:"/rest/patrolPoint/add",method:"post",data:e})}function p(e,t){return Object(o["a"])({url:"/rest/patrolPoint/stopOrStart",method:"get",params:{id:e,uid:t}})}function f(e,t){return Object(o["a"])({url:"/rest/patrolPoint/remove",method:"get",params:{id:e,uid:t}})}function d(e){return Object(o["a"])({url:"/rest/patrolPoint/modify",method:"post",data:e})}function h(e){return Object(o["a"])({url:"/rest/patrolDefaultConfig/saveOrModify",method:"post",data:e})}function m(e){return Object(o["a"])({url:"/rest/patrolPoint/patrolPointRepeat",method:"post",data:e})}function v(e){return Object(o["a"])({url:"/rest/patrolDefaultConfig/getPatrolPointDefault",method:"get",params:{companyId:e}})}},e674:function(e,t,a){"use strict";var o=a("f611"),l=a.n(o);l.a},f611:function(e,t,a){}}]);