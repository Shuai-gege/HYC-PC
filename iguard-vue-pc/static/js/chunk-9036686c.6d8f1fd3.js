(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9036686c"],{"34bd":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticStyle:{"margin-top":"20px","max-width":"600px","margin-left":"80px"}},[n("el-row",{attrs:{gutter:30}},[n("el-col",{attrs:{span:10}},[n("el-input",{attrs:{placeholder:"输入关键字进行过滤",clearable:""},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1),e._v(" "),n("el-col",{attrs:{span:30}},[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["/rest/department/companyAdd"],expression:"['/rest/department/companyAdd']"}],staticClass:"filter-item",attrs:{type:"primary"},on:{click:function(t){return e.handleCreate()}}},[n("i",{staticClass:"el-icon-plus"}),e._v(" 添加企业/部门\n        ")])],1)],1),e._v(" "),n("el-row",{staticStyle:{"padding-top":"20px"}},[n("el-col",[n("el-tree",{ref:"tree",staticClass:"permission-tree",attrs:{data:e.departments,props:e.defaultProps,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,"filter-node-method":e.filterNode},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,a=t.data;return n("span",{staticClass:"custom-tree-node"},[n("span",[e._v(e._s(r.label))]),e._v(" "),n("span",[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["/rest/department/add"],expression:"['/rest/department/add']"}],attrs:{type:"text",size:"mini"},on:{click:function(){return e.handleCreate(a)}}},[e._v("添加子项")]),e._v(" "),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["/rest/department/update"],expression:"['/rest/department/update']"}],attrs:{type:"text",size:"mini"},on:{click:function(){return e.handleEdit(r,a)}}},[e._v("编辑")]),e._v(" "),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["/rest/department/delete"],expression:"['/rest/department/delete']"}],attrs:{type:"text",size:"mini"},on:{click:function(){return e.handleDelete(a)}}},[e._v("删除")])],1)])}}])})],1)],1)],1),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogVisible,title:"edit"===e.dialogType?"编辑":"新增"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{ref:"form",attrs:{model:e.company,rules:e.rules,"label-width":"80px","label-position":"right"}},[n("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"类型",prop:"department.deptCompany"}},[n("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getDeptCompany},model:{value:e.company.department.deptCompany,callback:function(t){e.$set(e.company.department,"deptCompany",t)},expression:"company.department.deptCompany"}},[n("el-option",{attrs:{label:"部门",value:1}}),e._v(" "),n("el-option",{attrs:{label:"企业",value:2}})],1)],1),e._v(" "),n("el-form-item",{attrs:{label:e.isCompany?"企业名称":"部门名称",prop:"department.name"}},[n("el-input",{attrs:{placeholder:e.isCompany?"企业名称":"部门名称"},model:{value:e.company.department.name,callback:function(t){e.$set(e.company.department,"name",t)},expression:"company.department.name"}})],1),e._v(" "),e.isDepartment?n("el-form-item",{attrs:{label:"上级部门",prop:"department.parentId"}},[n("treeselect",{attrs:{options:e.companySubDepartments,normalizer:e.normalizer,placeholder:"选择上级部门"},model:{value:e.company.department.parentId,callback:function(t){e.$set(e.company.department,"parentId",t)},expression:"company.department.parentId"}})],1):e._e(),e._v(" "),e.isCompany?n("el-form-item",{attrs:{label:"管理账号",prop:"user.name"}},[n("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.company.user.name,callback:function(t){e.$set(e.company.user,"name",t)},expression:"company.user.name"}})],1):e._e(),e._v(" "),e.isCompany?n("el-form-item",{attrs:{label:"密码",prop:"user.password"}},[n("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.company.user.password,callback:function(t){e.$set(e.company.user,"password",t)},expression:"company.user.password"}})],1):e._e(),e._v(" "),e.isCompany?n("el-form-item",{attrs:{label:"真实姓名",prop:"user.vserName"}},[n("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.company.user.vserName,callback:function(t){e.$set(e.company.user,"vserName",t)},expression:"company.user.vserName"}})],1):e._e(),e._v(" "),e.isCompany?n("el-form-item",{attrs:{label:"角色",prop:"user.roleIds"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.company.user.roleIds,callback:function(t){e.$set(e.company.user,"roleIds",t)},expression:"company.user.roleIds"}},e._l(e.roles,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),e._v(" "),n("el-form-item",{attrs:{label:"排序"}},[n("el-input",{attrs:{placeholder:"排序"},model:{value:e.company.department.sorts,callback:function(t){e.$set(e.company.department,"sorts",t)},expression:"company.department.sorts"}})],1)],1),e._v(" "),n("div",{staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.confirmDepartment}},[e._v("确定")])],1)],1),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogVisibleEdit,title:"编辑"},on:{"update:visible":function(t){e.dialogVisibleEdit=t}}},[n("el-form",{ref:"form",attrs:{model:e.company,rules:e.rules,"label-width":"80px","label-position":"right"}},[n("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"类型",prop:"department.deptCompany"}},[n("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getDeptCompany},model:{value:e.company.department.deptCompany,callback:function(t){e.$set(e.company.department,"deptCompany",t)},expression:"company.department.deptCompany"}},[n("el-option",{attrs:{label:"部门",value:1}}),e._v(" "),n("el-option",{attrs:{label:"企业",value:2}})],1)],1),e._v(" "),n("el-form-item",{attrs:{label:e.isCompany?"企业名称":"部门名称",prop:"department.name"}},[n("el-input",{attrs:{placeholder:e.isCompany?"企业名称":"部门名称"},model:{value:e.company.department.name,callback:function(t){e.$set(e.company.department,"name",t)},expression:"company.department.name"}})],1),e._v(" "),e.isDepartment?n("el-form-item",{attrs:{label:"上级部门",prop:"department.parentId"}},[n("treeselect",{attrs:{options:e.companySubDepartments,normalizer:e.normalizer,placeholder:"选择上级部门"},model:{value:e.company.department.parentId,callback:function(t){e.$set(e.company.department,"parentId",t)},expression:"company.department.parentId"}})],1):e._e(),e._v(" "),n("el-form-item",{attrs:{label:"排序"}},[n("el-input",{attrs:{placeholder:"排序"},model:{value:e.company.department.sorts,callback:function(t){e.$set(e.company.department,"sorts",t)},expression:"company.department.sorts"}})],1)],1),e._v(" "),n("div",{staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisibleEdit=!1}}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.confirmDepartment}},[e._v("确定")])],1)],1),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogTopCompanyAdd,title:"新增"},on:{"update:visible":function(t){e.dialogTopCompanyAdd=t}}},[n("el-form",{ref:"form",attrs:{model:e.company,rules:e.rules,"label-width":"80px","label-position":"right"}},[n("el-form-item",{attrs:{label:"企业名称",prop:"department.name"}},[n("el-input",{attrs:{placeholder:"企业名称"},model:{value:e.company.department.name,callback:function(t){e.$set(e.company.department,"name",t)},expression:"company.department.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"管理账号",prop:"user.name"}},[n("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.company.user.name,callback:function(t){e.$set(e.company.user,"name",t)},expression:"company.user.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"密码",prop:"user.password"}},[n("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.company.user.password,callback:function(t){e.$set(e.company.user,"password",t)},expression:"company.user.password"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"真实姓名",prop:"user.vserName"}},[n("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.company.user.vserName,callback:function(t){e.$set(e.company.user,"vserName",t)},expression:"company.user.vserName"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"角色",prop:"user.roleIds"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.company.user.roleIds,callback:function(t){e.$set(e.company.user,"roleIds",t)},expression:"company.user.roleIds"}},e._l(e.roles,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"排序"}},[n("el-input",{attrs:{placeholder:"排序"},model:{value:e.company.department.sorts,callback:function(t){e.$set(e.company.department,"sorts",t)},expression:"company.department.sorts"}})],1)],1),e._v(" "),n("div",{staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogTopCompanyAdd=!1}}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.confirmDepartment}},[e._v("确定")])],1)],1)],1)},a=[],s=(n("ac6a"),n("7f7f"),n("96cf"),n("3b8d")),o=n("bd86"),i=n("ca17"),l=n.n(i),p=(n("542c"),n("4381")),c=n("653d"),m=n("db93"),d=n("ed08"),u={id:void 0,name:"",parentId:void 0,parentName:"",levels:void 0,deleted:0,deptCompany:1},y={name:"",password:"",vserName:"",roleIds:[]},f={department:{id:void 0,name:"",parentId:void 0,parentName:"",levels:void 0,deleted:0,deptCompany:1},user:{name:"",password:"",vserName:"",roleIds:[]}},b={name:"Department",components:{Treeselect:l.a},directives:{permission:p["a"]},data:function(){var e,t=function(e,t,n){return t&&/^1(3|4|5|6|7|8|9)\d{9}$/.test(t)?void 0:n(new Error("请输入正确的账号"))};return{defaultProps:{children:"childrens",label:"name"},department:Object.assign({},u),user:Object.assign({},y),departments:[],companySubDepartments:[],roles:[],dialogVisible:!1,dialogType:"new",dialogTopCompanyAdd:!1,dialogVisibleEdit:!1,isCompany:!1,isDepartment:!0,company:Object.assign({},f),levelsOptions:[{label:"集团",key:0},{label:"分公司",key:1},{label:"部门",key:2}],filterText:"",rules:(e={},Object(o["a"])(e,"department.deptCompany",[{required:!0,message:"请选择部门类型",trigger:"change"}]),Object(o["a"])(e,"department.name",[{required:!0,message:"请输入部门名",trigger:"blur"},{min:2,max:15,message:"长度在 2 到 15 个字符",trigger:"blur"}]),Object(o["a"])(e,"department.parentId",[{required:!0,message:"请选择上级部门",trigger:"change"}]),Object(o["a"])(e,"user.name",[{required:!0,message:"请输入正确的账号",trigger:"blur"},{validator:t,trigger:"blur"}]),Object(o["a"])(e,"user.vserName",[{required:!0,message:"请输入姓名",trigger:"blur"}]),Object(o["a"])(e,"user.roleIds",[{required:!0,message:"请选择角色",trigger:"change"}]),e)}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},created:function(){this.getRoles(),this.getSubDepartments(),this.getCompanySubDepartments()},methods:{getSubDepartments:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["g"])();case 2:t=e.sent,n=t.result,this.diGuiTree(n),this.departments=n;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getCompanySubDepartments:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["c"])();case 2:t=e.sent,n=t.result,this.diGuiTree(n),this.companySubDepartments=n;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getRoles:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(m["e"])();case 2:t=e.sent,this.roles=t.result;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getDeptCompany:function(){2===this.company.department.deptCompany?(this.isCompany=!0,this.isDepartment=!1):(this.isCompany=!1,this.isDepartment=!0)},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},diGuiTree:function(e){var t=this;e.forEach((function(e){""===e.childrens||void 0===e.childrens||null===e.childrens?delete e.childrens:t.diGuiTree(e.childrens)}))},normalizer:function(e){return{id:e.id,label:e.name,children:e.childrens}},topCompanyCreate:function(e){this.dialogTopCompanyAdd=!0,this.dialogType="topCompanyAdd",this.company=Object.assign({},f),this.user=Object.assign({},y)},handleCreate:function(e){this.dialogType="new",this.dialogVisible=!0,this.company.department=Object.assign({},f.department),console.log(f.department),this.company.user=Object.assign({},f.user),2===this.company.department.deptCompany?(this.isCompany=!0,this.isDepartment=!1):(this.isCompany=!1,this.isDepartment=!0)},handleEdit:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log(t),console.log(n),this.dialogType="edit",this.dialogVisibleEdit=!0,this.company.department=Object(d["c"])(n),this.company.department.deptCompany=n.dept_company,this.company.department.parentId=n.parent_id,2===this.company.department.deptCompany?(this.isCompany=!0,this.isDepartment=!1):(this.isCompany=!1,this.isDepartment=!0);case 8:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}(),confirmDepartment:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("edit"!==this.dialogType){e.next=5;break}return e.next=3,Object(c["i"])(this.company.department);case 3:e.next=14;break;case 5:if("new"!==this.dialogType){e.next=11;break}return this.company.user.password.length<1&&(this.company.user.password=this.company.user.name),e.next=9,Object(c["a"])(this.company);case 9:e.next=14;break;case 11:if("topCompanyAdd"!==this.dialogType){e.next=14;break}return e.next=14,Object(c["b"])(this.company);case 14:this.dialogVisible=!1,this.dialogTopCompanyAdd=!1,this.dialogVisibleEdit=!1,this.$message({showClose:!0,message:"保存成功",type:"success"}),this.getSubDepartments();case 19:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleDelete:function(e){var t=this;this.$confirm("确认删除?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(c["d"])(e.id);case 2:t.$message({showClose:!0,message:"删除成功",type:"success"}),t.getSubDepartments();case 4:case"end":return n.stop()}}),n)})))).catch((function(e){console.error(e)}))}}},h=b,v=(n("5771"),n("2877")),g=Object(v["a"])(h,r,a,!1,null,null,null);t["default"]=g.exports},"393b":function(e,t,n){},4381:function(e,t,n){"use strict";n("ac4d"),n("8a81"),n("ac6a");var r=n("4360"),a={inserted:function(e,t,n){var a=t.value,s=r["a"].getters&&r["a"].getters.permissions;if(!(a&&a instanceof Array&&a.length>0&&s))throw new Error("need permissions! Like v-permission=\"['/rest/user/list']\"");var o=!1,i=!0,l=!1,p=void 0;try{for(var c,m=s[Symbol.iterator]();!(i=(c=m.next()).done);i=!0){var d=c.value;if(d.url===a[0]){o=!0;break}}}catch(u){l=!0,p=u}finally{try{i||null==m.return||m.return()}finally{if(l)throw p}}o||e.remove()}},s=function(e){e.directive("permission",a)};window.Vue&&(window["permission"]=a,Vue.use(s)),a.install=s;t["a"]=a},"542c":function(e,t,n){},5771:function(e,t,n){"use strict";var r=n("393b"),a=n.n(r);a.a},"653d":function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return l})),n.d(t,"c",(function(){return p})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return d})),n.d(t,"i",(function(){return u})),n.d(t,"d",(function(){return y}));var r=n("b775"),a=n("7605"),s=n("30ca");function o(){return Object(a["a"])({url:"/rest/department/all",method:"get"})}function i(){return Object(s["a"])({url:"/rest/department/subDept",method:"get"})}function l(e){return Object(a["a"])({url:"/rest/department/subDeptByDeptId",method:"get",params:{deptId:e}})}function p(){return Object(s["a"])({url:"/rest/department/companySubDeptList",method:"get"})}function c(){return Object(a["a"])({url:"/rest/department/subCompanyList",method:"get"})}function m(e){return Object(r["a"])({url:"/rest/department/companyAdd",method:"post",data:e})}function d(e){return Object(a["a"])({url:"/rest/department/topCompanyAdd",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/rest/department/update",method:"post",data:e})}function y(e){return Object(a["a"])({url:"/rest/department/delete",method:"get",params:{id:e}})}},db93:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return p})),n.d(t,"c",(function(){return c}));var r=n("b775");function a(e){return Object(r["a"])({url:"/rest/role/list",method:"post",data:e})}function s(){return Object(r["a"])({url:"/rest/role/all",method:"get"})}function o(e){return Object(r["a"])({url:"/rest/role/add",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/rest/role/update",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/rest/role/delete",method:"get",params:{id:e}})}function p(e){return Object(r["a"])({url:"/rest/role/saveDataScope",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/rest/role/queryDataScope",method:"get",params:{id:e}})}}}]);